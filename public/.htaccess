#CGIPassAuth On

<IfModule mod_rewrite.c>

# apache auth basic auth example
#AuthUserFile /path/to/.htpasswd
#AuthName "phpIPAM authentication"
#AuthType Basic
#require valid-user

RewriteEngine on

# change rewrite base if not in root
# RewriteBase /

# passthroughs
RewriteRule ^static/.*$ - [L]
RewriteRule ^api/.*$ - [L]
RewriteRule ^saml/.*$ - [L]
RewriteRule ^index.php$ - [L]
RewriteRule ^env.php$ - [L]
RewriteRule ^(css|js|site|test)/.*$ - [L]
RewriteRule login/captcha/captchashow.php - [L]


# redirect errors
ErrorDocument 400 /error/400/
ErrorDocument 401 /error/401/
ErrorDocument 403 /error/403/
ErrorDocument 404 /error/404/
ErrorDocument 500 /error/500/

# IE login dashboard fix
RewriteRule ^login/dashboard/$ dashboard/ [R]
RewriteRule ^logout/dashboard/$ dashboard/ [R]
# search override
RewriteRule ^tools/search/(.*)$ index.php?page=tools&section=search&ip=$1 [L]

# custom per-app rewrites
#RewriteRule ^(.*)/devices/search/([0-9]+)/([0-9]+)/(.*) index.php?page=$1&section=devices&l=$2&p=$3&search=$4 [L]
RewriteRule ^(.*)/devices/search/([0-9]+)/(.*) index.php?page=$1&section=devices&p=$2&search=$3 [L]
RewriteRule ^(.*)/devices/search/(.*) index.php?page=$1&section=devices&search=$2 [L]
# RewriteRule ^(.*)/devices/([0-9]+)/([0-9]+)/$ index.php?page=$1&section=devices&l=$2&p=$3 [L]

# begin redoing rewrites
RewriteRule ^administration/devices/([0-9]+)/$ index.php?page=tools&section=devices&id=$1 [L]
RewriteRule ^(.*)/devices/([0-9]+)/$ index.php?page=$1&section=devices&id=$2 [L]
RewriteRule ^(.*)/devices/([0-9]+)/(.*)/$ index.php?page=$1&section=devices&id=$2&sPage=$3 [L]

# Rewrites
RewriteRule ^(.*)/(.*)/(.*)/(.*)/(.*)/(.*)/$ index.php?page=$1&section=$2&subnetId=$3&sPage=$4&ipaddrid=$5&tab=$6 [L]
RewriteRule ^(.*)/(.*)/(.*)/(.*)/(.*)/$ index.php?page=$1&section=$2&subnetId=$3&sPage=$4&ipaddrid=$5 [L]
RewriteRule ^(.*)/(.*)/(.*)/(.*)/$ index.php?page=$1&section=$2&subnetId=$3&sPage=$4 [L]
RewriteRule ^(.*)/(.*)/(.*)/$ index.php?page=$1&section=$2&subnetId=$3 [L]
RewriteRule ^(.*)/(.*)/$ index.php?page=$1&section=$2 [L,QSA]
RewriteRule ^(.*)/$ index.php?page=$1 [L]

</IfModule>
